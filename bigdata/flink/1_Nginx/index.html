<!-- build time:Fri May 23 2025 10:15:14 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="冬樱茶" href="https://github.com/Mayizono/miyazono.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="冬樱茶" href="https://github.com/Mayizono/miyazono.github.io/atom.xml"><link rel="alternate" type="application/json" title="冬樱茶" href="https://github.com/Mayizono/miyazono.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="https://github.com/Mayizono/miyazono.github.io/bigdata/flink/1_Nginx/"><title>负载均衡 Nginx 的使用 - Flink - 大数据 | Yume Shoka = 冬樱茶</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">负载均衡 Nginx 的使用</h1><div class="meta"><span class="item" title="创建时间：2020-09-21 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2020-09-21T00:00:00+08:00">2020-09-21</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>3.2k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>3 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Yume Shoka</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://i3.wp.com/wx4.sinaimg.cn/large/6833939bly1gicit4jrvuj20zk0m8785.jpg"></li><li class="item" data-background-image="https://i3.wp.com/wx4.sinaimg.cn/large/6833939bly1gipeyonbf9j20zk0m8e81.jpg"></li><li class="item" data-background-image="https://i3.wp.com/wx4.sinaimg.cn/large/6833939bly1giclj61ylzj20zk0m8b29.jpg"></li><li class="item" data-background-image="https://i3.wp.com/wx4.sinaimg.cn/large/6833939bly1gipevgoki5j20zk0m84qp.jpg"></li><li class="item" data-background-image="https://i3.wp.com/wx4.sinaimg.cn/large/6833939bly1giclxxcb6rj20zk0m8b29.jpg"></li><li class="item" data-background-image="https://i3.wp.com/wx4.sinaimg.cn/large/6833939bly1gicitcxhpij20zk0m8hdt.jpg"></li></ul></div><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div></header><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/bigdata/" itemprop="item" rel="index" title="分类于 大数据"><span itemprop="name">大数据</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/bigdata/flink/" itemprop="item" rel="index" title="分类于 Flink"><span itemprop="name">Flink</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://github.com/Mayizono/miyazono.github.io/bigdata/flink/1_Nginx/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Miyazono"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="冬樱茶"></span><div class="body md" itemprop="articleBody"><h2 id="负载均衡nginx的使用"><a class="anchor" href="#负载均衡nginx的使用">#</a> 负载均衡 Nginx 的使用</h2><hr><blockquote><p>该部分从属于数据采集部分，主要作用为实现几台数采服务器的负载均衡，因涉及新的技术 ---Nginx，所以单独成为一个 part</p></blockquote><p><img data-src="https://miyazono-1255488789.cos.ap-shanghai.myqcloud.com/markdown/20200719233514.png" alt="1594748402220"></p><h3 id="11-nginx概述"><a class="anchor" href="#11-nginx概述">#</a> 1.1 Nginx 概述</h3><p>Nginx 是一个高性能的 HTTP 和反向代理服务器，特点是占有内存少，并发能力强</p><ul><li>与 tomcat 的关系</li></ul><p>除了 tomcat 以外， apache,nginx,jboss,jetty 等都是 http 服务器。</p><p>nginx 和 apache 只支持静态页面和 CGI 协议的动态语言，比如 perl 、 php 等， 但是 nginx 不支持 java 。</p><p>Java 程序只能通过与 tomcat 配合完成。 nginx 与 tomcat 配合，为 tomcat 集群提供反向代理服务、负载均衡等服务</p><h4 id="111-nginx三大功能"><a class="anchor" href="#111-nginx三大功能">#</a> 1.1.1 Nginx 三大功能</h4><h5 id="反向代理"><a class="anchor" href="#反向代理">#</a> 反向代理</h5><ul><li>正向代理</li></ul><p><img data-src="https://miyazono-1255488789.cos.ap-shanghai.myqcloud.com/markdown/20200719233520.png" alt="1594748623769"></p><blockquote><p>服务器代理用户的请求，从用户的角度看，没法直接获取请求，需要通过代理<br>特点：代理用户，用户清楚知道访问哪台服务器</p></blockquote><ul><li>反向代理</li></ul><p><img data-src="https://miyazono-1255488789.cos.ap-shanghai.myqcloud.com/markdown/20200719233526.png" alt="1594748632948"></p><blockquote><p>反向代理：服务器代理真正服务器，用户不确定去哪台真实服务器，</p></blockquote><h5 id="负载均衡"><a class="anchor" href="#负载均衡">#</a> 负载均衡</h5><p>・轮询（默认） 每个请求按时间顺序逐一分配到不同的后端服务器，如果后端某台服务器宕机，则自动剔除故障机器，使用户访问不受影响</p><p>・weight 指定轮询权重，weight 值越大，分配到的几率就越高，主要用于后端每台服务器性能不均衡的情况。</p><p>・备机模式 平时不工作，只有其他 down 机的时候才会开始工作</p><p>・公平模式 (第三方) 更智能的一个负载均衡算法，此算法可以根据页面大小和加载时间长短智能地进行负载均衡，也就是根据后端服务器的响应时间来分配请求，响应时间短的优先分配。如果想要使用此调度算法，需要 Nginx 的 upstream_fair 模块。</p><h5 id="动静分离"><a class="anchor" href="#动静分离">#</a> 动静分离</h5><p><img data-src="https://miyazono-1255488789.cos.ap-shanghai.myqcloud.com/markdown/20200719233531.png" alt="1594748722077"></p><h3 id="12-nginx安装"><a class="anchor" href="#12-nginx安装">#</a> 1.2 Nginx 安装</h3><ul><li>yum 安装依赖包</li></ul><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> yum -y <span class="token function">install</span>    openssl openssl-devel pcre pcre-devel    zlib zlib-devel gcc gcc-c++</pre></td></tr></table></figure><ul><li>下载 Nginx</li></ul><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>/opt/software » <span class="token function">wget</span> http://nginx.org/download/nginx-1.12.2.tar.gz</pre></td></tr></table></figure><ul><li>解压</li></ul><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">tar</span> -zxvf nginx-1.12.2.tar.gz -C /opt/module</pre></td></tr></table></figure><ul><li>编译和安装</li></ul><p>进入解压缩的目录</p><p>为了防止出现权限问题，建议切换到 root 用户</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>./configure   --prefix<span class="token operator">=</span>/usr/local/webserver/nginx</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span></pre></td></tr></table></figure><ul><li><strong>启停 Nginx</strong></li></ul><p>进入目录: /usr/local/webserver/nginx</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>启动 nginx: sbin/nginx</pre></td></tr><tr><td data-num="2"></td><td><pre>关闭 nginx: sbin/nginx -s stop</pre></td></tr><tr><td data-num="3"></td><td><pre>重新加载: sbin/nginx -s reload</pre></td></tr></table></figure><blockquote><p>注意：</p><ul><li>Nginx 默认使用的是 80 端口，由于非 root 用户不能使用 1024 以内的端口，所以建议使用 root 用户启动 Nginx</li><li>如果使用普通用户启动 Nginx, 需要先执行下面的命令来突破上面的限制:</li></ul><pre><code>sudo setcap cap_net_bind_service=+eip /usr/local/webserver/nginx
</code></pre></blockquote><ul><li>查看 Nginx 进程</li></ul><p>![1594748930149](<span class="exturl" data-url="aHR0cHM6Ly9saWFuLXpwLm9zcy1jbi1zaGVuemhlbi5hbGl5dW5jcy5jb20vcGlj">https://lian-zp.oss-cn-shenzhen.aliyuncs.com/pic</span> GO/20200719233543.png)</p><p>通过网页访问: <span class="exturl" data-url="aHR0cDovL2hhZG9vcDEwOQ==">http://hadoop109</span></p><p><img data-src="https://miyazono-1255488789.cos.ap-shanghai.myqcloud.com/markdown/20200719233548.png" alt="1594748945767"></p><h3 id="13-配置负载均衡"><a class="anchor" href="#13-配置负载均衡">#</a> 1.3 配置负载均衡</h3><h4 id="131-nginx配置修改"><a class="anchor" href="#131-nginx配置修改">#</a> 1.3.1 Nginx 配置修改</h4><ul><li>修改 /usr/local/webserver/nginx/conf/nginx.conf</li></ul><figure class="highlight properties"><figcaption data-lang=".properties"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token attr-name">http</span> <span class="token attr-value">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    .....</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">    # 配置上游服务器：其实就被代理的服务器，springboot</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token attr-name">    upstream</span> <span class="token attr-value">logserver&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token attr-name">        server</span> <span class="token attr-value">hadoop109:8081 weight=1;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token attr-name">        server</span> <span class="token attr-value">hadoop110:8081 weight=1;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token attr-name">        server</span> <span class="token attr-value">hadoop111:8081 weight=1;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    &#125;</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token attr-name">    server</span> <span class="token attr-value">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token attr-name">        listen</span> <span class="token attr-value">      80;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token attr-name">        server_name</span> <span class="token attr-value"> logserver;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token attr-name">        location</span> <span class="token attr-value">/ &#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token attr-name">            root</span> <span class="token attr-value">  html;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token attr-name">            index</span> <span class="token attr-value"> index.html index.htm;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">            # 配置代理</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token attr-name">            proxy_pass</span> <span class="token attr-value">http://logserver;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token attr-name">            proxy_connect_timeout</span> <span class="token attr-value">10;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        &#125;</pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>        ...</pre></td></tr><tr><td data-num="23"></td><td><pre>    &#125;</pre></td></tr><tr><td data-num="24"></td><td><pre>&#125;</pre></td></tr></table></figure><blockquote><p><strong>Q：为什么不配置日志服务器端口为 8080</strong></p><p>在 kafka 启动消费数据前要先打开 zookeeper 集群，在 zookeeper3.5.0 之后的版本中，集群打开后会默认占用 8080 端口</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>atguigu@hadoop109 module<span class="token punctuation">]</span>$ jps</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">13317</span> Jps</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token number">13229</span> QuorumPeerMain</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span>atguigu@hadoop109 module<span class="token punctuation">]</span>$ <span class="token function">netstat</span> -tunlp <span class="token operator">|</span><span class="token function">grep</span> <span class="token number">8080</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">(</span>Not all processes could be identified, non-owned process info</pre></td></tr><tr><td data-num="6"></td><td><pre>will not be shown, you would have to be root to see it all.<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>tcp6       <span class="token number">0</span>      <span class="token number">0</span> :::8080                 :::*                    LISTEN      <span class="token number">13229</span>/java</pre></td></tr></table></figure><p>通过观察日志可以发现确实启动了一个叫 adminServer 的服务</p><p><img data-src="https://miyazono-1255488789.cos.ap-shanghai.myqcloud.com/markdown/20200719233556.png" alt="1594749317598"></p><p>这是一个内嵌的 jetty 服务。如果想在 zookeeper 上解决这个问题，有以下三种方法</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>（1）.删除jetty。（2）修改端口。修改方法的方法有两种，一种是在启动脚本中增加 -Dzookeeper.admin.serverPort<span class="token operator">=</span>你的端口号.一种是在zoo.cfg中增加admin.serverPort<span class="token operator">=</span>没有被占用的端口号（3）停用这个服务，在启动脚本中增加”-Dzookeeper.admin.enableServer<span class="token operator">=</span>false”</pre></td></tr></table></figure><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">netstat</span> -tunlp<span class="token operator">|</span><span class="token function">grep</span> 端口号 查看占用端口的进程</pre></td></tr></table></figure></blockquote><h4 id="132-日志采集服务器群起脚本制作"><a class="anchor" href="#132-日志采集服务器群起脚本制作">#</a> 1.3.2 日志采集服务器群起脚本制作</h4><p>分别在 3 个节点启动 jar 比较麻烦，制作统一启动脚本.</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token shebang important">#!/bin/bashcase $1 in    "start")    &#123;        for i in hadoop201 hadoop202 hadoop203        do            echo "========启动日志服务: $i==============="            ssh $i  "source /etc/profile ; java -jar /opt/module/gmall/gmall-logger-1.0-SNAPSHOT.jar >/dev/null 2>&amp;1  &amp;"        done     &#125;;;    "stop")    &#123;        for i in hadoop201 hadoop202 hadoop203        do            echo "========关闭日志服务: $i==============="            ssh $i "ps -ef|grep gmall-logger-1.0-SNAPSHOT.jar | grep -v grep|awk '&#123;print \$2&#125;'|xargs kill" >/dev/null 2>&amp;1        done    &#125;;;        *)    &#123;        echo 启动姿势不对, 请使用参数 start 启动日志服务, 使用参数 stop 停止服务    &#125;;;esac</span></pre></td></tr></table></figure><h4 id="133-其他操作"><a class="anchor" href="#133-其他操作">#</a> 1.3.3 其他操作</h4><ul><li>分发启动采集服务器 jar 包到其余设备</li><li>给编写好的脚本增加执行权限</li><li>启动 Nginx</li><li>启动脚本</li></ul><blockquote><p>脚本编写的注意事项：</p><p>如果在 windows 环境下编写脚本后复制到 linux 系统中出现如下报错：</p><pre><code>bad interpreter:/bin/bash^M: no such file or directory
</code></pre><p>是因为在 window 下写的脚本回车的时候使用的是 \r\n, 而在 linux 使用 \n 就可以了，所在每行的末尾多了一个 \r.</p><p>使用下面的命令去掉行尾的 \r:</p><pre><code>sed -i -e 's/\r$//' gmall_cluster
</code></pre></blockquote><ul><li>测试日志生成能否在集群中生成落盘日志与控制台打印</li></ul></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2021-10-03 08:00:08" itemprop="dateModified" datetime="2021-10-03T08:00:08+08:00">2021-10-03</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Miyazono <i class="ic i-at"><em>@</em></i>冬樱茶</li><li class="link"><strong>本文链接：</strong> <a href="https://github.com/Mayizono/miyazono.github.io/bigdata/flink/1_Nginx/" title="负载均衡 Nginx 的使用">https://github.com/Mayizono/miyazono.github.io/bigdata/flink/1_Nginx/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/bigdata/hive/leetcode%E6%95%B0%E6%8D%AE%E5%BA%93%E9%A2%98%E7%9B%AE1-123%E9%A2%98%EF%BC%8820-08-14)/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;i3.wp.com&#x2F;wx4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicitcxhpij20zk0m8hdt.jpg" title="力扣数据库"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> Hive</span><h3>力扣数据库</h3></a></div><div class="item right"><a href="/bigdata/kafka/Kafka%E3%80%81Redis%E3%80%81Pulsar%E5%AF%B9%E6%AF%94/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;i3.wp.com&#x2F;wx4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipexbei4hj20zk0m8npd.jpg" title="Kafka、Redis、Pulsar对比"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> Kafka</span><h3>Kafka、Redis、Pulsar对比</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1nginx%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.</span> <span class="toc-text">负载均衡 Nginx 的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-nginx%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 Nginx 概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#111-nginx%E4%B8%89%E5%A4%A7%E5%8A%9F%E8%83%BD"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1.1 Nginx 三大功能</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">反向代理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">负载均衡</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">动静分离</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-nginx%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 Nginx 安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E9%85%8D%E7%BD%AE%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 配置负载均衡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#131-nginx%E9%85%8D%E7%BD%AE%E4%BF%AE%E6%94%B9"><span class="toc-number">1.3.1.</span> <span class="toc-text">1.3.1 Nginx 配置修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#132-%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BE%A4%E8%B5%B7%E8%84%9A%E6%9C%AC%E5%88%B6%E4%BD%9C"><span class="toc-number">1.3.2.</span> <span class="toc-text">1.3.2 日志采集服务器群起脚本制作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#133-%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C"><span class="toc-number">1.3.3.</span> <span class="toc-text">1.3.3 其他操作</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/bigdata/flink/1_Nginx/" rel="bookmark" title="负载均衡Nginx的使用">负载均衡Nginx的使用</a></li><li><a href="/bigdata/flink/Flink%E7%9A%84Window%E6%9C%BA%E5%88%B6/" rel="bookmark" title="Flink的窗口机制">Flink的窗口机制</a></li><li><a href="/bigdata/flink/Flink%E7%9A%84%E6%9E%B6%E6%9E%84/" rel="bookmark" title="Flink的架构">Flink的架构</a></li><li><a href="/bigdata/flink/Flink%E7%9A%84%E5%BC%82%E6%AD%A5IO/" rel="bookmark" title="Flink的异步IO">Flink的异步IO</a></li><li><a href="/bigdata/flink/Flink%E5%85%B3%E8%81%94%E7%BB%B4%E8%A1%A8%E6%96%B9%E6%A1%88/" rel="bookmark" title="Flink关联维表方案">Flink关联维表方案</a></li><li><a href="/bigdata/flink/Flink%E7%AE%A1%E7%90%86Kafka%E7%9A%84%E6%B6%88%E8%B4%B9%E4%BD%8D%E7%82%B9/" rel="bookmark" title="Flink管理 Kafka 消费位点">Flink管理 Kafka 消费位点</a></li><li><a href="/bigdata/flink/Flink%E5%AE%9E%E6%88%98%E8%AE%A1%E7%AE%97%E7%83%AD%E9%97%A8%E5%95%86%E5%93%81/" rel="bookmark" title="Flink实战计算热门商品">Flink实战计算热门商品</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Miyazono" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Miyazono</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">25</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">14</span> <span class="name">分类</span></a></div></nav><div class="social"><a href="https://github.com/Mayizono" title="https:&#x2F;&#x2F;github.com&#x2F;Mayizono" class="item github"><i class="ic i-github"></i></a> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTEzNDMzNjQzOQ==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;134336439"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vdS8yOTAwNzY4Nzky" title="https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;2900768792"><i class="ic i-weibo"></i></span> <span class="exturl item email" data-url="aHR0cHM6Ly94eW5zdHVkeUAxNjMuY29t" title="https:&#x2F;&#x2F;xynstudy@163.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li><li class="item"><a href="/mikutap/" rel="section"><i class="ic i-star"></i>mikutap</a></li><li class="item"><a href="/time" rel="section"><i class="ic i-heart"></i>time</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/bigdata/hive/leetcode%E6%95%B0%E6%8D%AE%E5%BA%93%E9%A2%98%E7%9B%AE1-123%E9%A2%98%EF%BC%8820-08-14)/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/bigdata/kafka/Kafka%E3%80%81Redis%E3%80%81Pulsar%E5%AF%B9%E6%AF%94/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/bigdata/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/bigdata/flume/" title="分类于 Flume">Flume</a></div><span><a href="/bigdata/flume/Flume/" title="Flume基础学习">Flume基础学习</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/bigdata/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/bigdata/hive/" title="分类于 Hive">Hive</a></div><span><a href="/bigdata/hive/leetcode%E6%95%B0%E6%8D%AE%E5%BA%93%E9%A2%98%E7%9B%AE1-123%E9%A2%98%EF%BC%8820-08-14)/" title="力扣数据库">力扣数据库</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/bigdata/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/bigdata/zookeeper/" title="分类于 Zookeeper">Zookeeper</a></div><span><a href="/bigdata/zookeeper/zookeeper%E6%80%BB%E7%BB%93/" title="zookeeper总结">zookeeper总结</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/bigdata/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/bigdata/flink/" title="分类于 Flink">Flink</a></div><span><a href="/bigdata/flink/Flink%E7%9A%84%E6%9E%B6%E6%9E%84/" title="Flink的架构">Flink的架构</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/bigdata/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/bigdata/kafka/" title="分类于 Kafka">Kafka</a></div><span><a href="/bigdata/kafka/Kafka%E3%80%81Redis%E3%80%81Pulsar%E5%AF%B9%E6%AF%94/" title="Kafka、Redis、Pulsar对比">Kafka、Redis、Pulsar对比</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/bigdata/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/bigdata/flume/" title="分类于 Flume">Flume</a></div><span><a href="/bigdata/flume/Flume%E7%BB%83%E4%B9%A0/" title="Flume练习题">Flume练习题</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/bigdata/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/bigdata/hadoop/" title="分类于 Hadoop">Hadoop</a></div><span><a href="/bigdata/hadoop/hadoop/" title="Hadoop学习">Hadoop学习</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/bigdata/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/bigdata/flink/" title="分类于 Flink">Flink</a></div><span><a href="/bigdata/flink/Flink%E7%AE%A1%E7%90%86Kafka%E7%9A%84%E6%B6%88%E8%B4%B9%E4%BD%8D%E7%82%B9/" title="Flink管理 Kafka 消费位点">Flink管理 Kafka 消费位点</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/bigdata/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/bigdata/kafka/" title="分类于 Kafka">Kafka</a></div><span><a href="/bigdata/kafka/Kafka%E6%80%BB%E7%BB%93/" title="Kafka学习">Kafka学习</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/bigdata/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/bigdata/flink/" title="分类于 Flink">Flink</a></div><span><a href="/bigdata/flink/Flink%E5%AE%9E%E6%88%98%E8%AE%A1%E7%AE%97%E7%83%AD%E9%97%A8%E5%95%86%E5%93%81/" title="Flink实战计算热门商品">Flink实战计算热门商品</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Miyazono @ Yume Shoka</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">311k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">4:43</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<a href="https://github.com/amehime/hexo-theme-shoka">Shoka</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"bigdata/flink/1_Nginx/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(i){return i.includes("#")},function(i){return new RegExp(LOCAL.path+"$").test(i)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->